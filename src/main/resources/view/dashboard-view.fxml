<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<AnchorPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.depichan.controller.DashboardController"
            minWidth="800" minHeight="600">
    <children>
        <ScrollPane fitToWidth="true" fitToHeight="true" 
                   AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0" 
                   AnchorPane.rightAnchor="0" AnchorPane.bottomAnchor="0"
                   hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
            <content>
                <VBox spacing="15" minWidth="800">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>
                    
                    <!-- Header -->
                    <HBox alignment="CENTER" minHeight="50">
                        <Label text="Dashboard Toko Kelontong" 
                               style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                    </HBox>
                    
                    <!-- Responsive Metrics Grid -->
                    <GridPane hgap="15" vgap="15" alignment="CENTER">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                            <ColumnConstraints percentWidth="25" minWidth="200"/>
                        </columnConstraints>
                        
                        <!-- Metric Card 1 -->
                        <VBox styleClass="metric-card" minHeight="120" maxHeight="150"
                              style="-fx-background-color: linear-gradient(to bottom, #e3f2fd, #bbdefb); 
                                     -fx-background-radius: 8; -fx-border-radius: 8; 
                                     -fx-border-color: #2196f3; -fx-border-width: 2;
                                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 4, 0, 0, 2);"
                              GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Penjualan Hari Ini" 
                                   style="-fx-font-weight: bold; -fx-font-size: 14px; -fx-text-fill: #1976d2;"/>
                            <Label fx:id="labelSalesToday" text="Rp 0" 
                                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #0d47a1;"
                                   VBox.vgrow="ALWAYS"/>
                            <Label fx:id="labelSalesTodayTrx" text="0 transaksi" 
                                   style="-fx-font-size: 12px; -fx-text-fill: #424242;"/>
                        </VBox>
                        
                        <!-- Metric Card 2 -->
                        <VBox styleClass="metric-card" minHeight="120" maxHeight="150"
                              style="-fx-background-color: linear-gradient(to bottom, #ffebee, #ffcdd2); 
                                     -fx-background-radius: 8; -fx-border-radius: 8; 
                                     -fx-border-color: #f44336; -fx-border-width: 2;
                                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 4, 0, 0, 2);"
                              GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Stok Menipis" 
                                   style="-fx-font-weight: bold; -fx-font-size: 14px; -fx-text-fill: #d32f2f;"/>
                            <Label fx:id="labelLowStock" text="0 barang" 
                                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #b71c1c;"
                                   VBox.vgrow="ALWAYS"/>
                            <Hyperlink fx:id="linkLowStockDetail" text="Lihat detail" 
                                      onAction="#showLowStockItems"
                                      style="-fx-font-size: 12px; -fx-text-fill: #1976d2;"/>
                        </VBox>
                        
                        <!-- Metric Card 3 -->
                        <VBox styleClass="metric-card" minHeight="120" maxHeight="150"
                              style="-fx-background-color: linear-gradient(to bottom, #e8f5e8, #c8e6c9); 
                                     -fx-background-radius: 8; -fx-border-radius: 8; 
                                     -fx-border-color: #4caf50; -fx-border-width: 2;
                                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 4, 0, 0, 2);"
                              GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Nilai Persediaan" 
                                   style="-fx-font-weight: bold; -fx-font-size: 14px; -fx-text-fill: #388e3c;"/>
                            <Label fx:id="labelInventoryValue" text="Rp 0" 
                                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #1b5e20;"
                                   VBox.vgrow="ALWAYS"/>
                            <Label fx:id="labelTotalItems" text="0 barang" 
                                   style="-fx-font-size: 12px; -fx-text-fill: #424242;"/>
                        </VBox>
                        
                        <!-- Metric Card 4 -->
                        <VBox styleClass="metric-card" minHeight="120" maxHeight="150"
                              style="-fx-background-color: linear-gradient(to bottom, #fffde7, #fff9c4); 
                                     -fx-background-radius: 8; -fx-border-radius: 8; 
                                     -fx-border-color: #ffeb3b; -fx-border-width: 2;
                                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 4, 0, 0, 2);"
                              GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <Label text="Penjualan Minggu Ini" 
                                   style="-fx-font-weight: bold; -fx-font-size: 14px; -fx-text-fill: #f57f17;"/>
                            <Label fx:id="labelSalesWeek" text="Rp 0" 
                                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #e65100;"
                                   VBox.vgrow="ALWAYS"/>
                            <Label fx:id="labelSalesWeekTrx" text="0 transaksi" 
                                   style="-fx-font-size: 12px; -fx-text-fill: #424242;"/>
                        </VBox>
                    </GridPane>
                    
                    <!-- Charts and Tables Section with Responsive Layout -->
                    <GridPane hgap="15" vgap="15" VBox.vgrow="ALWAYS">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="60" minWidth="400"/>
                            <ColumnConstraints percentWidth="40" minWidth="300"/>
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints minHeight="300" vgrow="ALWAYS"/>
                        </rowConstraints>
                        
                        <!-- Sales Trend Chart -->
                        <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="0"
                              style="-fx-background-color: white; -fx-background-radius: 8; 
                                     -fx-border-radius: 8; -fx-border-color: #e0e0e0; -fx-border-width: 1;
                                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 6, 0, 0, 3);">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="ðŸ“Š" style="-fx-font-size: 20px;"/>
                                <Label text="Tren Penjualan (7 Hari Terakhir)" 
                                       style="-fx-font-weight: bold; -fx-font-size: 16px; -fx-text-fill: #2c3e50;"/>
                            </HBox>
                            <BarChart fx:id="salesTrendChart" legendVisible="false" 
                                     VBox.vgrow="ALWAYS" animated="true"
                                     style="-fx-background-color: transparent;">
                                <xAxis>
                                    <CategoryAxis fx:id="salesTrendX" label="Tanggal" 
                                                 style="-fx-tick-label-font-size: 12px;"/>
                                </xAxis>
                                <yAxis>
                                    <NumberAxis fx:id="salesTrendY" label="Total Penjualan (Rp)" 
                                               style="-fx-tick-label-font-size: 12px;"/>
                                </yAxis>
                            </BarChart>
                        </VBox>
                        
                        <!-- Top Selling Products Table -->
                        <VBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0"
                              style="-fx-background-color: white; -fx-background-radius: 8; 
                                     -fx-border-radius: 8; -fx-border-color: #e0e0e0; -fx-border-width: 1;
                                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 6, 0, 0, 3);">
                            <padding>
                                <Insets top="15" right="15" bottom="15" left="15"/>
                            </padding>
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="ðŸ†" style="-fx-font-size: 20px;"/>
                                <Label text="Produk Terlaris Bulan Ini" 
                                       style="-fx-font-weight: bold; -fx-font-size: 16px; -fx-text-fill: #2c3e50;"/>
                            </HBox>
                            <TableView fx:id="topProductsTable" VBox.vgrow="ALWAYS"
                                      style="-fx-background-color: transparent; -fx-table-cell-border-color: #e0e0e0;">
                                <columns>
                                    <TableColumn fx:id="colProductName" text="Nama Barang" 
                                               style="-fx-alignment: CENTER-LEFT;"/>
                                    <TableColumn fx:id="colProductQty" text="Terjual" prefWidth="70"
                                               style="-fx-alignment: CENTER;"/>
                                    <TableColumn fx:id="colProductTotal" text="Total" prefWidth="100"
                                               style="-fx-alignment: CENTER-RIGHT;"/>
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                                </columnResizePolicy>
                            </TableView>
                        </VBox>
                    </GridPane>
                    
                    <!-- Action Buttons with Responsive Layout -->
                    <HBox spacing="15" alignment="CENTER" minHeight="60">
                        <Button text="ðŸ›ï¸ Kelola Barang" onAction="#goToProductManagement" 
                               minWidth="150" prefHeight="40"
                               style="-fx-background-color: linear-gradient(to bottom, #4CAF50, #45a049); 
                                      -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14px;
                                      -fx-background-radius: 20; -fx-border-radius: 20;
                                      -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.2), 3, 0, 0, 1);"/>
                        <Button text="ðŸ”„ Refresh Data" onAction="#refreshDashboard" 
                               minWidth="150" prefHeight="40"
                               style="-fx-background-color: linear-gradient(to bottom, #2196F3, #1976D2); 
                                      -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14px;
                                      -fx-background-radius: 20; -fx-border-radius: 20;
                                      -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.2), 3, 0, 0, 1);"/>
                    </HBox>
                </VBox>
            </content>
        </ScrollPane>
    </children>
</AnchorPane>
